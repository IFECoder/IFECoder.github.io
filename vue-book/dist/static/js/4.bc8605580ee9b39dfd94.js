webpackJsonp([4],{tcnj:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("Gu7T"),r=o.n(n),s=o("Xxa5"),a=o.n(s),i=o("exGp"),c=o.n(i),u=o("UeVD"),v=o("gyMJ"),l=o("Cpzh"),f={data:function(){return{books:[],offset:0,hasMore:!0,isLoading:!1}},mounted:function(){var e=this,t=this.$refs.scroll,o=t.offsetTop,n=0,r=!1;t.addEventListener("touchstart",function(s){if(0==t.scrollTop&&t.offsetTop==o){var a=s.touches[0].pageY,i=function e(s){r=!0;var i=s.touches[0].pageY;(n=i-a)>0?n<=50?t.style.top=n+o+"px":(n=50,t.style.top=o+50+"px"):(t.removeEventListener("touchmove",e),t.removeEventListener("touchend",c))},c=function s(a){r&&(r=!1,clearInterval(e.timer1),e.timer1=setInterval(function(){if(n<=0)return clearInterval(e.timer1),n=0,t.style.top=o+"px",t.removeEventListener("touchmove",i),t.removeEventListener("touchend",s),e.books=[],e.offset=0,e.hasMore=!0,void e.getBook();n-=1,t.style.top=o+n+"px"},1))};t.addEventListener("touchmove",i),t.addEventListener("touchend",c)}},!1)},created:function(){this.getBook()},methods:{addCart:function(e){this.$store.commit(l.a,e)},loadMore:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout(function(){var t=e.$refs.scroll;t.scrollTop+t.clientHeight+20>t.scrollHeight&&e.getBook()},60)},more:function(){this.getBook()},removeData:function(e){var t=this;return c()(a.a.mark(function o(){return a.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(v.e)(e);case 2:t.books=t.books.filter(function(t){return t.bookId!==e});case 3:case"end":return o.stop()}},o,t)}))()},getBook:function(){var e=this;return c()(a.a.mark(function t(){var o,n,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.hasMore||e.isLoading){t.next=10;break}return t.next=3,Object(v.d)(e.offset);case 3:o=t.sent,n=o.hasMore,s=o.books,e.books=[].concat(r()(e.books),r()(s)),e.hasMore=n,e.isLoading=!1,e.offset=e.books.length;case 10:case"end":return t.stop()}},t,e)}))()}},computed:{},components:{MHeader:u.a}},d={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("MHeader",[e._v("列表页")]),e._v(" "),o("div",{ref:"scroll",staticClass:"content",on:{scroll:e.loadMore}},[o("ul",e._l(e.books,function(t,n){return o("router-link",{key:n,attrs:{to:{name:"detail",params:{bid:t.bookId}},tag:"li"}},[o("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.bookCover,expression:"book.bookCover"}]}),e._v(" "),o("div",[o("h4",[e._v(e._s(t.bookName))]),e._v(" "),o("p",[e._v(e._s(t.bookInfo))]),e._v(" "),o("b",[e._v("￥"+e._s(t.bookPrice))]),e._v(" "),o("div",{staticClass:"btn-list"},[o("button",{on:{click:function(o){o.stopPropagation(),e.removeData(t.bookId)}}},[e._v("删除")]),e._v(" "),o("button",{on:{click:function(o){o.stopPropagation(),e.addCart(t)}}},[e._v("添加")])])])])})),e._v(" "),o("div",{staticClass:"more",on:{click:e.more}},[e._v("加载更多")])])],1)},staticRenderFns:[]};var p=o("VU/8")(f,d,!1,function(e){o("yQ2D")},"data-v-a7c7e180",null);t.default=p.exports},yQ2D:function(e,t){}});
//# sourceMappingURL=4.bc8605580ee9b39dfd94.js.map